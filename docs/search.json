[{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":null,"dir":"","previous_headings":"","what":"MitoDrift package documentation TODO","title":"MitoDrift package documentation TODO","text":"Date: 2026-02-03 checklist focuses polishing user-facing documentation mitodrift R package prior publication.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_1-decide-the-target-standard","dir":"","previous_headings":"","what":"1) Decide the target standard","title":"MitoDrift package documentation TODO","text":"Target distribution: internal + GitHub release vs. CRAN/Bioconductor-style checks.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_2-readme-first-impression","dir":"","previous_headings":"","what":"2) README (first impression)","title":"MitoDrift package documentation TODO","text":"Add/verify 5–7 sentence overview: problem → idea → users get → typical inputs/outputs. Inputs: objects/files expected (mtDNA allele counts, tree, metadata). Outputs: gets returned (phylo, support, trimmed tree, clade table, plots). confidence / posterior clade support confidence trimming root-singletons mtSDI detectability-dependent upper bound","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"input-data-requirements","dir":"","previous_headings":"2) README (first impression)","what":"Input data requirements","title":"MitoDrift package documentation TODO","text":"Long format (mut_dat): one row per cell-variant pair columns variant, cell, (alt reads), d (total depth) Matrix format: separate matrices alt counts (amat) depth (dmat), variants × cells Document helper functions format conversion: mut_mat_to_long(), filter_mut_long() Minimum number cells / variants reliable inference Recommended coverage VAF thresholds variant filtering","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"inference-settings-and-diagnostics","dir":"","previous_headings":"2) README (first impression)","what":"Inference settings and diagnostics","title":"MitoDrift package documentation TODO","text":"tree_mcmc_burnin: many initial samples discard (default increase) tree_mcmc_chains: number independent runs (10 typical, 50 thorough analysis) tree_mcmc_batch_size: often check convergence ASDSF threshold (conv_thres): trees across chains agree sufficiently interpret diagnostics output (tree_mcmc_diag.rds) Document resume interrupted runs.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"plotting-and-outputs","dir":"","previous_headings":"2) README (first impression)","what":"Plotting and outputs","title":"MitoDrift package documentation TODO","text":"expected input classes required columns plot communicates common misreads Include 1–2 example figures README vignette output (small).","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_4-vignettes--articles-deeper-guidance","dir":"","previous_headings":"","what":"4) Vignettes / articles (deeper guidance)","title":"MitoDrift package documentation TODO","text":"preprocessing assumptions fitting/inference steps confidence trimming choosing τ interpreting clades / root-singletons computing interpreting mtSDI","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"clone-assignment-workflow","dir":"","previous_headings":"4) Vignettes / articles (deeper guidance)","what":"Clone assignment workflow","title":"MitoDrift package documentation TODO","text":"Document recommended workflow defining clones trees: - [ ] Step 1: Trim low-confidence branches: phy_trim = trim_tree(phy, conf = τ) - [ ] Step 2 (optional): Remove root singletons subset specific cells: - use drop_singletons() (e.g., excluding unresolved cells diversity calculations) - use keep_tip_safe() (e.g., focusing cell type subset) - [ ] Step 3: Assign cells clones: assign_clones_polytomy(phy_trim, k = ...) - [ ] Explain choices affect downstream metrics like SDI.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_5-documentation-website","dir":"","previous_headings":"","what":"5) Documentation website","title":"MitoDrift package documentation TODO","text":"Goal: publish clean, navigable documentation site (similar kharchenkolab/numbat). GitHub Pages via docs/ main, GitHub Pages via gh-pages branch (recommended cleaner git history). Set url: _pkgdown.yml eventual Pages URL. Add short site title/tagline links (paper, issues, source repo) navbar. Create Articles landing page (workflow overview + interpretation notes). Group Reference index logical sections (e.g., inference, trimming/clades, benchmarking, plotting, utilities). Ensure trim_tree() assign_clones_polytomy() docs explicitly cover root-singletons mtSDI interpretation. Document build preview site locally publishing. Set GitHub Actions rebuild site code changes. Configure GitHub Pages hosting. Add badges README.md (docs, version). Ensure homepage highlights: MitoDrift , key assumptions, links tutorials. Keep examples small site builds quickly.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_6-roxygen-coverage-and-consistency","dir":"","previous_headings":"","what":"6) Roxygen coverage and consistency","title":"MitoDrift package documentation TODO","text":"purpose, arguments (types/units/ranges), return value minimal working examples conf / tau / tol meaning default choices tree$node.label contains (support values, scale, missing handling) trim_tree() assign_clones_polytomy() k: maximum clade size collapses one clone paraphyletic: handle leftover unassigned cells trimming produces conservative summary, statement non-relatedness “singleton clone” operational unit, biological claim","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_7-package-level-metadata","dir":"","previous_headings":"","what":"7) Package-level metadata","title":"MitoDrift package documentation TODO","text":"Ensure DESCRIPTION accurate Title/Description, URLs, BugReports, Authors@R. inst/CITATION (R-style) /CITATION.cff repo root. README “cite” paper + software version. Verify license text LICENSE.md matches intended license.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_8-pre-release-checks","dir":"","previous_headings":"","what":"8) Pre-release checks","title":"MitoDrift package documentation TODO","text":"Run R CMD check locally; fix issues. Ensure source files tracked (temporary/build files). Add NEWS.md track changes versions. Add simple versioning policy.","code":""},{"path":"https://teng-gao.github.io/mitodrift/DOCS_TODO.html","id":"id_9-final-pre-publication-sweep","dir":"","previous_headings":"","what":"9) Final pre-publication sweep","title":"MitoDrift package documentation TODO","text":"“clade”, “clone”, “root singleton”, “confidence trimming”, “support” Add cross-references Methods text package docs (definitions). Confirm figure/metric names match paper (mtSDI, τ, etc.).","code":""},{"path":"https://teng-gao.github.io/mitodrift/articles/tutorial.html","id":"ml-tree","dir":"Articles","previous_headings":"","what":"ML tree","title":"MitoDrift tutorial","text":"","code":"tree_list = KX003_1_tree_list$tree_list tree_ml = tree_list %>% .[[length(.)]] plot_phylo_heatmap2(     tree_ml,      KX003_1_mut_dat,     dot_size = 0.1,     branch_width = 0.3,     branch_length = F,     het_max = 1,     title = 'ML' )"},{"path":"https://teng-gao.github.io/mitodrift/articles/tutorial.html","id":"consensus-tree-with-clade-confidence","dir":"Articles","previous_headings":"","what":"Consensus tree with clade confidence","title":"MitoDrift tutorial","text":"","code":"# KX003_1_mcmc contains 3 chains of phylo trees - flatten and apply burnin burnin = 100 mcmc_trees = lapply(KX003_1_mcmc, function(chain) chain[(burnin + 1):length(chain)]) %>%     unlist(recursive = FALSE) class(mcmc_trees) = \"multiPhylo\"  # Build consensus tree with clade frequencies using ape tree_cons = ape::consensus(mcmc_trees, p = 0.5, rooted = TRUE)  # Use prop.part to compute clade frequencies pp = ape::prop.part(mcmc_trees) clade_freqs = attr(pp, \"number\") / length(mcmc_trees) tree_cons$node.label = round(clade_freqs[1:tree_cons$Nnode], 2)  plot_phylo_heatmap2(     tree_cons,     KX003_1_mut_dat,     dot_size = 1,     branch_width = 0.3,     branch_length = F,     node_conf = T,     het_max = 1,     title = 'Consensus' )"},{"path":"https://teng-gao.github.io/mitodrift/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Teng Gao. Author, maintainer.","code":""},{"path":"https://teng-gao.github.io/mitodrift/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gao, T. (2026). MitoDrift: Reconstructing single-cell lineage history mitochondrial DNA heteroplasmy drift. bioRxiv (Preprint). URL: https://github.com/teng-gao/mitodrift","code":"@Article{,   title = {MitoDrift: Reconstructing single-cell lineage history from mitochondrial DNA heteroplasmy drift},   author = {Teng Gao},   journal = {bioRxiv},   year = {2026},   note = {Preprint},   url = {https://github.com/teng-gao/mitodrift}, }"},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"mitodrift","dir":"","previous_headings":"","what":"MitoDrift","title":"MitoDrift","text":"MitoDrift reconstructs single-cell lineage relationships mitochondrial DNA (mtDNA) mutations modeling heteroplasmy drift measurement noise Wright–Fisher hidden Markov Tree (WF-HMT). applies population genetics principles (genetic drift) model mtDNA heteroplasmy single cells order reconstruct high-precision lineage trees single-cell genomics/multiome data. MitoDrift uses expectation-maximization (EM) obtain maximum-likelihood estimates drift, mutation, error rates, performs phylogenetic MCMC quantify uncertainty tree topology. primary output confidence-calibrated phylogeny posterior clade support, downstream summaries confidence-trimmed trees clone partitions. Inputs can mtDNA allele counts single-cell genomics assays capture mtDNA variation (e.g., mtscATAC-seq, MAESTER, ReDeeM).","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"MitoDrift","text":"faster MCMC trace IO, install qs2 TBB:","code":"# from a local checkout if (!requireNamespace(\"devtools\", quietly = TRUE)) install.packages(\"devtools\") devtools::install_local(\".\") remotes::install_cran(\"qs2\", type = \"source\", configure.args = \"--with-TBB --with-simd=AVX2\")"},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"MitoDrift","text":"uses tiny example dataset packaged inst/extdata/. can run terminal package root (settings intentionally small/fast demo): Outputs mitodrift_demo/ include mitodrift_object.rds plus tree files diagnostics. run finishes:","code":"Rscript inst/bin/run_mitodrift_em.R \\   --mut_dat inst/extdata/small_test_mut_dat.csv \\   --outdir mitodrift_demo \\   --tree_mcmc_iter 50 \\   --tree_mcmc_chains 2 \\   --tree_mcmc_burnin 10 library(mitodrift) mut_dat <- read.csv(   system.file(\"extdata\", \"small_test_mut_dat.csv\", package = \"mitodrift\") ) md <- readRDS(\"mitodrift_demo/mitodrift_object.rds\") phy_trim <- trim_tree(md$tree_annot, conf = 0.5)  plot_phylo_heatmap2(   phy_trim,   mut_dat,   dot_size = 1,   branch_width = 0.3,   branch_length = FALSE,   node_conf = TRUE,   het_max = 1 )"},{"path":[]},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"long-format-mut_dat","dir":"","previous_headings":"Input data requirements","what":"Long format (mut_dat)","title":"MitoDrift","text":"One row per cell–variant pair, counts alternate allele () total depth (d). IMPORTANT: Include rows = 0 every cell × variant combination represented (observation model uses total depth).","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"matrix-pair-format-amat-dmat","dir":"","previous_headings":"Input data requirements","what":"Matrix pair format (amat, dmat)","title":"MitoDrift","text":"Wide matrices variant first column cells subsequent columns. Use layout amat (alt counts) dmat (total depth).","code":""},{"path":[]},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"model-parameters-em-fitting","dir":"","previous_headings":"Inference settings & diagnostics","what":"Model parameters (EM fitting)","title":"MitoDrift","text":"--fit_params: Enable automatic parameter fitting via EM (default: TRUE) --fit_param_max_iter: Maximum EM iterations (default: 100) --fit_param_epsilon: EM convergence threshold parameter changes (default: 1e-3) --k: Number VAF bins discretizing heteroplasmy levels (default: 20) --npop: Population size Wright-Fisher model (default: 600) --eps: Mutation rate per branch (default: 0.001; auto-fitted fit_params=TRUE) --err: Variant detection error rate (default: 0; auto-fitted fit_params=TRUE) --ngen: Number WF generations (default: 100; auto-fitted fit_params=TRUE)","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"phylogenetic-mcmc-settings","dir":"","previous_headings":"Inference settings & diagnostics","what":"Phylogenetic MCMC settings","title":"MitoDrift","text":"--tree_mcmc_chains: Number independent MCMC runs (default: 1; recommended 10-50 robust inference. large trees e.g., >8000 cells, use less chains avoid memory limits) --tree_mcmc_iter: Maximum iterations per chain (default: 100; can overridden automatic termination via ASDSF convergence check) --conv_thres: ASDSF threshold MCMC termination (default: NULL; e.g., 0.05-0.1 auto-convergence). ASDSF (Average Standard Deviation Split Frequencies) summarizes topology agreement across chains. lower value indicates good mixing. Values < 0.05 indicate good convergence; < 0.1 acceptable exploratory analyses large trees. --tree_mcmc_batch_size: Iteration interval saving traces checking convergence (default: 1000) --tree_mcmc_burnin: Initial samples discard chain (default: 0; recommended 10-20% iterations)","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"parallelization-options","dir":"","previous_headings":"Inference settings & diagnostics","what":"Parallelization options","title":"MitoDrift","text":"--ncores: Default number cores likelihood computation tree optimization (default: 1) --ncores_em: Cores parallel EM parameter fitting across variants (default: 1) NOTE: Different ncores_nj values may yield slightly different NJ topologies due floating-point rounding --ncores_qs: Cores parallel file /O (qs2 compression) MCMC annotation (default: 1) --ncores_annot: Cores computing clade frequencies MCMC traces (default: --ncores)","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"resuming-interrupted-job","dir":"","previous_headings":"Inference settings & diagnostics","what":"Resuming interrupted job","title":"MitoDrift","text":"Use --resume TRUE continue interrupted runs saved traces","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"core-concepts-for-interpretation","dir":"","previous_headings":"","what":"Core concepts for interpretation","title":"MitoDrift","text":"Initial tree topology: point-estimate starting tree constructed using neighbor joining (NJ) continuous VAF matrices. provides fully-resolved (binary) initialization empirically captures strong lineage signal posterior sampling. Posterior clade support: per-node support values tree$node.label (0–1) estimated MCMC topology sampling. Confidence trimming: collapse internal edges support cutoff τ obtain confidence-calibrated lineage tree.","code":""},{"path":"https://teng-gao.github.io/mitodrift/index.html","id":"clone-assignment-workflow","dir":"","previous_headings":"","what":"Clone assignment workflow","title":"MitoDrift","text":"Trim low-confidence edges: Assign clones (top-level root-descending clades):","code":"tau <- 0.5 phy_trim <- trim_tree(phy, conf = tau) clade_df <- assign_clones_polytomy(phy_trim, k = Inf, return_df = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":null,"dir":"Reference","previous_headings":"","what":"MitoDrift R6 Class — MitoDrift","title":"MitoDrift R6 Class — MitoDrift","text":"MitoDrift R6 Class MitoDrift R6 Class","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MitoDrift R6 Class — MitoDrift","text":"class mitochondrial drift analysis tree-based inference","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"MitoDrift R6 Class — MitoDrift","text":"tree_init Initial phylogenetic tree (ape::phylo) Transition matrix leaf_likelihoods List leaf likelihoods logA Vector log transition probabilities logP List log probabilities model_params Named vector containing model parameters (eps, err, npop, ngen, k) amat Alternative allele count matrix dmat Total depth matrix vmat VAF matrix mcmc_trace MCMC trace parameter fitting tree_list List trees optimization tree_ml Maximum likelihood tree tree_annot Annotated tree clade frequencies ml_trace_file File path ML trace mcmc_trace_file File path MCMC trace mcmc_diag_file File path MCMC diagnostics param_trace_file File path parameter fitting trace","code":""},{"path":[]},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"MitoDrift R6 Class — MitoDrift","text":"MitoDrift$new() MitoDrift$print() MitoDrift$make_model() MitoDrift$fit_params_em() MitoDrift$optimize_tree() MitoDrift$run_mcmc() MitoDrift$annotate_tree() MitoDrift$copy() MitoDrift$clone()","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"MitoDrift R6 Class — MitoDrift","text":"Initialize MitoDrift object","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$new(   mut_dat = NULL,   amat = NULL,   dmat = NULL,   model_params = NULL,   build_tree = TRUE,   ncores = 1 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"mut_dat Mutation data long format (data.frame columns: variant, cell, d, ) amat Alternative allele count matrix (optional, mut_dat provided) dmat Total depth matrix (optional, mut_dat provided) model_params Model parameters (optional) build_tree Whether build initial NJ tree (default: TRUE) ncores Number cores used building initial NJ tree (default: 1)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"MitoDrift R6 Class — MitoDrift","text":"Print object summary Prints summary MitoDrift object including data dimensions, tree information, model parameters, available components.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$print()"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"None (prints console)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-make-model-","dir":"Reference","previous_headings":"","what":"Method make_model()","title":"MitoDrift R6 Class — MitoDrift","text":"Make model components","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$make_model(model_params = NULL, ncores = 1)"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"model_params Model parameters (optional) ncores Number cores use","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"None","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-fit-params-em-","dir":"Reference","previous_headings":"","what":"Method fit_params_em()","title":"MitoDrift R6 Class — MitoDrift","text":"Fit tree parameters using Expectation-Maximization (EM) algorithm","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$fit_params_em(   tree_fit,   initial_params = c(ngen = 100, log_eps = log(0.001), log_err = log(0.001)),   lower_bounds = c(ngen = 1, log_eps = log(1e-12), log_err = log(1e-12)),   upper_bounds = c(ngen = 1000, log_eps = log(0.2), log_err = log(0.2)),   max_iter = 10,   epsilon = 0.001,   ncores = 1 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"tree_fit Tree fit parameters initial_params Initial parameter values (ngen, log_eps, log_err) lower_bounds Lower bounds parameters transformed space upper_bounds Upper bounds parameters transformed space max_iter Maximum number EM iterations (default: 10) epsilon Convergence threshold (default: 1e-3) ncores Number cores use (default: 3) trace Whether return trace parameter values (default: TRUE)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"Fitted parameters list parameters trace","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-optimize-tree-","dir":"Reference","previous_headings":"","what":"Method optimize_tree()","title":"MitoDrift R6 Class — MitoDrift","text":"Optimize tree using C++ implementation","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$optimize_tree(   max_iter = 100,   ncores = 1,   outfile = NULL,   resume = FALSE,   trace_interval = 5 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"max_iter Maximum number iterations (default: 100) ncores Number cores use (default: 1) outfile Output file saving results (optional) resume Whether resume existing file (default: FALSE) trace_interval Interval saving trace (default: 5)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"Optimization result object","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-run-mcmc-","dir":"Reference","previous_headings":"","what":"Method run_mcmc()","title":"MitoDrift R6 Class — MitoDrift","text":"Run phylogenetic MCMC sampling","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$run_mcmc(   max_iter = 10000,   conv_thres = NULL,   nchains = 1000,   ncores = 1,   ncores_qs = 1,   batch_size = 1000,   outfile = NULL,   resume = FALSE,   diag = TRUE,   use_nj = FALSE,   diagfile = NULL )"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"max_iter Maximum number MCMC iterations (default: 10000) conv_thres Convergence threshold ASDSF (default: NULL) nchains Number MCMC chains (default: 1000) ncores Number cores use (default: 1) ncores_qs Number cores use QS operations (default: 1) batch_size Batch size MCMC (default: 1000) outfile Output file saving results (optional) resume Whether resume existing file (default: FALSE) diag Whether compute ASDSF diagnostics (default: TRUE) use_nj Whether use NJ tree instead ML tree initial tree (default: FALSE) diagfile File path saving ASDSF diagnostics (RDS)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"MCMC result object","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-annotate-tree-","dir":"Reference","previous_headings":"","what":"Method annotate_tree()","title":"MitoDrift R6 Class — MitoDrift","text":"Trim tree using MCMC results","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$annotate_tree(   burnin = 0,   max_iter = 1e+08,   use_nj = FALSE,   ncores = 1,   ncores_qs = 1,   mcmc_trace_file = NULL )"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"burnin Number burnin iterations (default: 0) max_iter Maximum iteration include (default: 1e8) use_nj Whether use NJ tree instead ML tree (default: FALSE) ncores Number cores use (default: 1) ncores_qs Number cores use QS operations (default: 1) mcmc_trace_file MCMC result file (optional, uses stored file NULL)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"Annotate tree clade frequencies","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-copy-","dir":"Reference","previous_headings":"","what":"Method copy()","title":"MitoDrift R6 Class — MitoDrift","text":"Create copy MitoDrift object updated structure method creates new MitoDrift instance data updated class structure. Useful refreshing objects created older versions code.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$copy(old_obj, rebuild_tree = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"old_obj old MitoDrift object copy rebuild_tree Whether rebuild initial tree data (default: FALSE)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"MitoDrift R6 Class — MitoDrift","text":"new MitoDrift object data","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"MitoDrift R6 Class — MitoDrift","text":"objects class cloneable method.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"MitoDrift R6 Class — MitoDrift","text":"","code":"MitoDrift$clone(deep = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/MitoDrift.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"MitoDrift R6 Class — MitoDrift","text":"deep Whether make deep clone.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/P_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Example genotype probability matrix — P_example","title":"Example genotype probability matrix — P_example","text":"Example genotype probability matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/P_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example genotype probability matrix — P_example","text":"","code":"P_example"},{"path":"https://teng-gao.github.io/mitodrift/reference/P_example.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example genotype probability matrix — P_example","text":"object class matrix (inherits array) 1000 rows 25 columns.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/P_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Smaller example genotype probability matrix — P_small","title":"Smaller example genotype probability matrix — P_small","text":"Smaller example genotype probability matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/P_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smaller example genotype probability matrix — P_small","text":"","code":"P_small"},{"path":"https://teng-gao.github.io/mitodrift/reference/P_small.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Smaller example genotype probability matrix — P_small","text":"object class matrix (inherits array) 100 rows 25 columns.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/add_clade_freq.html","id":null,"dir":"Reference","previous_headings":"","what":"Add clade frequencies to a phylogenetic tree — add_clade_freq","title":"Add clade frequencies to a phylogenetic tree — add_clade_freq","text":"Computes frequency (support) clade reference phylogeny (phy) across list phylogenetic trees (edge_list), adds frequencies node labels reference tree.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/add_clade_freq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add clade frequencies to a phylogenetic tree — add_clade_freq","text":"","code":"add_clade_freq(phy, edge_list, rooted = TRUE, ncores = 1)"},{"path":"https://teng-gao.github.io/mitodrift/reference/add_clade_freq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add clade frequencies to a phylogenetic tree — add_clade_freq","text":"phy reference phylogeny class phylo. edge_list list edge matrices (phylogenetic trees) compare reference tree. rooted Logical; whether treat trees rooted. Default TRUE. ncores Integer; number cores use parallel computation. Default 1 (parallelization).","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/add_clade_freq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add clade frequencies to a phylogenetic tree — add_clade_freq","text":"phylo object clade frequencies added node labels.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/add_node_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Add ","title":"Add ","text":"Add \"Node\" labels internal nodes phylo tree","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/add_node_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add ","text":"","code":"add_node_names(tree, prefix = \"Node\", start_from_tip = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/add_node_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add ","text":"tree phylo object prefix Character prefix node names (default \"Node\") start_from_tip Logical; TRUE (default), node numbering starts ntip + 1 (standard ape convention); FALSE, numbering starts 1.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/add_node_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add ","text":"phylo object, tree$node.label set prefix + node numbers","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/annotate_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"Find maximum lilkelihood assignment mutations tree","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/annotate_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"","code":"annotate_tree(tree, P)"},{"path":"https://teng-gao.github.io/mitodrift/reference/annotate_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"tree phylo Single-cell phylogenetic tree P matrix Genotype probability matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/annotate_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"tbl_graph single-cell phylogeny mutation placements","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/annotate_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"","code":"gtree_small = annotate_tree(tree_small, P_small)"},{"path":"https://teng-gao.github.io/mitodrift/reference/assign_clones_polytomy.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign clone IDs to a tree allowing small polytomies. — assign_clones_polytomy","title":"Assign clone IDs to a tree allowing small polytomies. — assign_clones_polytomy","text":"Assign clone IDs tree allowing small polytomies.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/assign_clones_polytomy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign clone IDs to a tree allowing small polytomies. — assign_clones_polytomy","text":"","code":"assign_clones_polytomy(tree, k = Inf, paraphyletic = FALSE, return_df = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/assign_clones_polytomy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign clone IDs to a tree allowing small polytomies. — assign_clones_polytomy","text":"tree Rooted phylo object bifurcating polytomous structure. k Positive scalar; maximum clade size collapses one clone. paraphyletic Logical; TRUE, leftover unassigned tips node grouped one clone, otherwise becomes singleton. return_df Logical; TRUE, returns data frame annotated per tip, otherwise integer vector clone assignments.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/assign_clones_polytomy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign clone IDs to a tree allowing small polytomies. — assign_clones_polytomy","text":"Either data frame columns cell, clade, annot, size, frac integer vector clone IDs indexed tip order.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/assign_clones_polytomy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign clone IDs to a tree allowing small polytomies. — assign_clones_polytomy","text":"Finds root (node never used child), recurses internal nodes, assigns clone IDs whenever clade <= k tips. Tips directly attached root always singleton clones. Ensures tips receive assignment, warning late singletons required.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/collect_chains.html","id":null,"dir":"Reference","previous_headings":"","what":"Collect MCMC chains into a multiPhylo object — collect_chains","title":"Collect MCMC chains into a multiPhylo object — collect_chains","text":"Reconstructs phylo trees raw edge-list chains, applies burn-removal iteration truncation, pools chains single multiPhylo object.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/collect_chains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collect MCMC chains into a multiPhylo object — collect_chains","text":"","code":"collect_chains(edge_list_all, phy_init, burnin = 0, max_iter = Inf)"},{"path":"https://teng-gao.github.io/mitodrift/reference/collect_chains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collect MCMC chains into a multiPhylo object — collect_chains","text":"edge_list_all List chains, list 2-column integer edge matrices. phy_init initial phylo object whose tip labels metadata used reconstruct full phylo objects. burnin Integer; number initial samples discard chain. max_iter Numeric; maximum iteration retain (samples beyond dropped).","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/collect_chains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collect MCMC chains into a multiPhylo object — collect_chains","text":"multiPhylo object containing pooled post-burn-trees.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute ASDSF across chains using clades from a target tree — compute_target_tree_asdsf","title":"Compute ASDSF across chains using clades from a target tree — compute_target_tree_asdsf","text":"Compute ASDSF across chains using clades target tree","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute ASDSF across chains using clades from a target tree — compute_target_tree_asdsf","text":"","code":"compute_target_tree_asdsf(   phy_target,   edge_list_chains,   rooted = TRUE,   normalize = TRUE,   ncores = 1,   min_freq = 0 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute ASDSF across chains using clades from a target tree — compute_target_tree_asdsf","text":"phy_target rooted phylo object defining reference clades. Assumed postorder. edge_list_chains List chains, list edge matrices (2-column integer matrices). rooted Logical; treat trees rooted matching clades. Default TRUE. normalize Logical; pass prop_clades_par (default TRUE). min_freq Minimum clade frequency threshold used averaging SDs. Default 0.1.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute ASDSF across chains using clades from a target tree — compute_target_tree_asdsf","text":"list elements asdsf, per_clade_sd, keep_mask, freq_matrix.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf_sliding.html","id":null,"dir":"Reference","previous_headings":"","what":"Sliding-window ASDSF for a target tree — compute_target_tree_asdsf_sliding","title":"Sliding-window ASDSF for a target tree — compute_target_tree_asdsf_sliding","text":"Applies compute_target_tree_asdsf() sequential, fixed-width windows MCMC chain returns ASDSF trajectory point uses samples end corresponding window (cumulative windows, akin get_asdsfs).","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf_sliding.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sliding-window ASDSF for a target tree — compute_target_tree_asdsf_sliding","text":"","code":"compute_target_tree_asdsf_sliding(   phy_target,   edge_list_chains,   window_size = 50L,   burnin = 0L,   rooted = TRUE,   normalize = TRUE,   min_freq = 0,   ncores = 1,   min_chains = 1L )"},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf_sliding.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sliding-window ASDSF for a target tree — compute_target_tree_asdsf_sliding","text":"phy_target rooted phylo object defining reference clades. edge_list_chains List chains, list edge matrices (2-column integer matrices) ordered iteration. window_size Positive integer; number successive samples base window. Cumulative estimates computed multiples size. burnin Non-negative integer; number initial samples discard chain windowing. rooted Logical; treat trees rooted matching clades (passed compute_target_tree_asdsf). normalize Logical; passed compute_target_tree_asdsf. min_freq Minimum clade frequency threshold averaging SDs. Passed compute_target_tree_asdsf. min_chains Minimum number chains required filtering.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/compute_target_tree_asdsf_sliding.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sliding-window ASDSF for a target tree — compute_target_tree_asdsf_sliding","text":"data.frame one row per window containing ASDSF value, window bounds (1-indexed, post-burnin), attributes window_size, step, burnin.","code":""},{"path":[]},{"path":"https://teng-gao.github.io/mitodrift/reference/convert_logliks_to_logP_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert log-likelihood matrices to a log-probability list (row-major) — convert_logliks_to_logP_list","title":"Convert log-likelihood matrices to a log-probability list (row-major) — convert_logliks_to_logP_list","text":"Convert log-likelihood matrices log-probability list (row-major)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/convert_logliks_to_logP_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert log-likelihood matrices to a log-probability list (row-major) — convert_logliks_to_logP_list","text":"","code":"convert_logliks_to_logP_list(logliks, phy)"},{"path":"https://teng-gao.github.io/mitodrift/reference/convert_logliks_to_logP_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert log-likelihood matrices to a log-probability list (row-major) — convert_logliks_to_logP_list","text":"logliks Named list log-likelihood matrices (one per variant), dimension k x n_cells. phy phylo object whose tip labels determine column ordering.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/convert_logliks_to_logP_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert log-likelihood matrices to a log-probability list (row-major) — convert_logliks_to_logP_list","text":"named list numeric vectors, length k * n_nodes.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/cpp-internals.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal C++ utilities — cpp-internals","title":"Internal C++ utilities — cpp-internals","text":"Internal C++ utilities","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Decode a tree using CRF belief propagation (R version) — decode_tree","title":"Decode a tree using CRF belief propagation (R version) — decode_tree","text":"Constructs conditional random field (CRF) tree single shared transition matrix computes per-variant marginal beliefs via tree belief propagation. Optionally returns posterior means, MAP assignments, full CRF objects.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Decode a tree using CRF belief propagation (R version) — decode_tree","text":"","code":"decode_tree(   tn,   A,   liks,   post_max = FALSE,   store_bels = FALSE,   store_crfs = FALSE,   debug = FALSE,   score_only = FALSE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Decode a tree using CRF belief propagation (R version) — decode_tree","text":"tn phylo object representing tree topology. Transition matrix (square, k x k) VAF bin midpoints row/column names. liks Named list likelihood matrices (one per variant), k x n_cells. post_max Logical; TRUE, also compute MAP (Viterbi) decoding. store_bels Logical; TRUE, store per-variant node edge beliefs output. store_crfs Logical; TRUE, store copy CRF object variant. debug Logical; TRUE, return detailed list instead just tbl_graph. score_only Logical; TRUE, skip posterior computation attach log-partition scores.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Decode a tree using CRF belief propagation (R version) — decode_tree","text":"tbl_graph tree per-variant posterior means (columns p_<variant>) logZ vector log-partition-function values. debug = TRUE, list additional diagnostic components.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Decode tree using EM algorithm — decode_tree_em","title":"Decode tree using EM algorithm — decode_tree_em","text":"Decode tree using EM algorithm","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree_em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Decode tree using EM algorithm — decode_tree_em","text":"","code":"decode_tree_em(tn, A, liks, ncores = 1)"},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree_em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Decode tree using EM algorithm — decode_tree_em","text":"tn phylogenetic tree transition matrix liks leaf likelihoods ncores number cores use","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/decode_tree_em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Decode tree using EM algorithm — decode_tree_em","text":"list logZ, edge beliefs, node beliefs","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the root node ID of a rooted phylogeny. — find_root","title":"Find the root node ID of a rooted phylogeny. — find_root","text":"root identified node index appears parent tree$edge[, 1] never child tree$edge[, 2].","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the root node ID of a rooted phylogeny. — find_root","text":"","code":"find_root(tree)"},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the root node ID of a rooted phylogeny. — find_root","text":"tree rooted phylo object.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the root node ID of a rooted phylogeny. — find_root","text":"Integer node ID root.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root_split.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the clade node IDs adjacent to the root. — find_root_split","title":"Get the clade node IDs adjacent to the root. — find_root_split","text":"Returns child node IDs root (clades immediately root). rooted binary tree typically length 2.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root_split.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the clade node IDs adjacent to the root. — find_root_split","text":"","code":"find_root_split(tree)"},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root_split.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the clade node IDs adjacent to the root. — find_root_split","text":"tree rooted phylo object.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/find_root_split.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the clade node IDs adjacent to the root. — find_root_split","text":"Integer vector root child node IDs.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit tree parameters using EM algorithm — fit_params_em","title":"Fit tree parameters using EM algorithm — fit_params_em","text":"Fit tree parameters using EM algorithm","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit tree parameters using EM algorithm — fit_params_em","text":"","code":"fit_params_em(   tree_fit,   amat,   dmat,   initial_params = c(ngen = 100, log_eps = log(0.001), log_err = log(0.001)),   lower_bounds = c(ngen = 1, log_eps = log(1e-12), log_err = log(1e-12)),   upper_bounds = c(ngen = 1000, log_eps = log(0.2), log_err = log(0.2)),   max_iter = 10,   k = 20,   npop = 600,   ncores = 1,   epsilon = 0.001,   trace = TRUE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit tree parameters using EM algorithm — fit_params_em","text":"tree_fit phylogenetic tree amat alternative allele count matrix dmat total depth matrix initial_params initial parameter values (ngen, log_eps, log_err) lower_bounds lower bounds parameters transformed space upper_bounds upper bounds parameters transformed space max_iter maximum number iterations k number clusters likelihood computation npop population size likelihood computation ncores number cores use epsilon convergence threshold trace whether return trace parameter values","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit tree parameters using EM algorithm — fit_params_em","text":"parameter values list parameter values trace","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit tree parameters using EM (BP-backed, native ordering) — fit_params_em_cpp","title":"Fit tree parameters using EM (BP-backed, native ordering) — fit_params_em_cpp","text":"faster EM uses compute_node_edge_beliefs_bp2() directly. relies inherent ordering used C++ routine: node_beliefs[locus] n x C matrix APE node-id order (1..n) edge_beliefs[locus] m x C x C array m edges correspond post-ordered edge list internal C++ routine (order irrelevant sum edges).","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit tree parameters using EM (BP-backed, native ordering) — fit_params_em_cpp","text":"","code":"fit_params_em_cpp(   tree_fit,   amat,   dmat,   initial_params = c(ngen = 100, log_eps = log(0.001), log_err = log(0.001)),   lower_bounds = c(ngen = 1, log_eps = log(1e-12), log_err = log(1e-12)),   upper_bounds = c(ngen = 1000, log_eps = log(0.2), log_err = log(0.2)),   max_iter = 10,   k = 20,   npop = 600,   ncores = 1,   epsilon = 0.001,   trace = TRUE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit tree parameters using EM (BP-backed, native ordering) — fit_params_em_cpp","text":"tree_fit phylogenetic tree (renumbered) amat alternative allele counts dmat total depth matrix initial_params named numeric: ngen, log_eps, log_err lower_bounds named numeric lower bounds (names) upper_bounds named numeric upper bounds (names) max_iter maximum EM iterations k number hidden states (VAF bins) npop population size WF-HMM transition ncores kept API compatibility (unused ) epsilon convergence threshold parameter deltas trace TRUE, returns trace dataframe","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_em_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit tree parameters using EM (BP-backed, native ordering) — fit_params_em_cpp","text":"either named vector final params (ngen, eps, err) list(par=..., trace=...)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit tree parameters using MCMC — fit_params_mcmc","title":"Fit tree parameters using MCMC — fit_params_mcmc","text":"Estimates tree parameters (number generations, error rates) using MCMC sampling fmcmc package.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit tree parameters using MCMC — fit_params_mcmc","text":"","code":"fit_params_mcmc(   tree_fit,   amat,   dmat,   initial_params = c(ngen = 100, log_eps = log(0.001), log_err = log(0.001)),   lower_bounds = c(ngen = 1, log_eps = log(1e-18), log_err = log(1e-18)),   upper_bounds = c(ngen = 1000, log_eps = log(0.2), log_err = log(0.2)),   nsteps = 500,   nchains = 1,   outfile = NULL,   npop = 600,   k = 20,   ncores = 1,   keep = 100,   check_conv = FALSE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit tree parameters using MCMC — fit_params_mcmc","text":"tree_fit phylogenetic tree amat alternative allele count matrix dmat total depth matrix initial_params initial parameter values (ngen, log_eps, log_err) lower_bounds lower bounds parameters transformed space upper_bounds upper bounds parameters transformed space nsteps number MCMC steps nchains number MCMC chains outfile file save MCMC result npop population size likelihood computation k number clusters likelihood computation ncores number cores use keep number MCMC steps keep end chain check_conv whether check convergence parameter fitting","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/fit_params_mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit tree parameters using MCMC — fit_params_mcmc","text":"MCMC result object fmcmc","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_asdsfs.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimized version of get_asdsfs from rwty — get_asdsfs","title":"Optimized version of get_asdsfs from rwty — get_asdsfs","text":"Optimized version get_asdsfs rwty","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_asdsfs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimized version of get_asdsfs from rwty — get_asdsfs","text":"","code":"get_asdsfs(slide.freq.list, min.freq = 0.1)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat","text":"get leaft likelihoods given mutation data matrix format","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat","text":"","code":"get_leaf_liks_mat(amat, dmat, vafs, eps = 0, ncores = 1, log = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat","text":"amat matrix allele counts dmat matrix total counts vafs vector VAFs eps error rate log whether return log likelihoods","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat","text":"list likelihood matrices","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Leaf likelihood matrix via C++ backend — get_leaf_liks_mat_cpp","title":"Leaf likelihood matrix via C++ backend — get_leaf_liks_mat_cpp","text":"Leaf likelihood matrix via C++ backend","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Leaf likelihood matrix via C++ backend — get_leaf_liks_mat_cpp","text":"","code":"get_leaf_liks_mat_cpp(amat, dmat, vafs, eps = 0, ncores = 1L, log = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Leaf likelihood matrix via C++ backend — get_leaf_liks_mat_cpp","text":"amat Integer matrix alt counts (variants x cells). dmat Integer matrix depths (dimensions amat). vafs Numeric vector VAF grid points (names optional). eps Variant detection error rate add VAF bin (default 0). ncores Number threads use (default 1). log Whether return log-likelihoods instead probabilities.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Leaf likelihood matrix via C++ backend — get_leaf_liks_mat_cpp","text":"List matrices, one per variant, rows = VAF bins columns = cells.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_old.html","id":null,"dir":"Reference","previous_headings":"","what":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat_old","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat_old","text":"get leaft likelihoods given mutation data matrix format","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_old.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat_old","text":"","code":"get_leaf_liks_mat_old(amat, dmat, vafs, eps = 0, ncores = 1, log = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_old.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat_old","text":"amat matrix allele counts dmat matrix total counts vafs vector VAFs eps error rate log whether return log likelihoods","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_leaf_liks_mat_old.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get leaft likelihoods given mutation data in matrix format — get_leaf_liks_mat_old","text":"list likelihood matrices","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_mut_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"Convert single-cell phylogeny mutation placements mutation graph","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_mut_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"","code":"get_mut_graph(gtree)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_mut_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"gtree tbl_graph single-cell phylogeny","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_mut_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"igraph Mutation graph","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_mut_graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"","code":"mut_graph = get_mut_graph(gtree_small)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_param_lik_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the likelihood of a tree given model parameters — get_param_lik_cpp","title":"Compute the likelihood of a tree given model parameters — get_param_lik_cpp","text":"Compute likelihood tree given model parameters","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_param_lik_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the likelihood of a tree given model parameters — get_param_lik_cpp","text":"","code":"get_param_lik_cpp(tree_fit, amat, dmat, ngen, err, eps, npop = 600, k = 20)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_param_lik_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the likelihood of a tree given model parameters — get_param_lik_cpp","text":"tree_fit phylogenetic tree ngen number generations err error rate eps mutation rate npop population size k number clusters likelihood computation","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_param_lik_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the likelihood of a tree given model parameters — get_param_lik_cpp","text":"log-likelihood","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_slide_freq_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimized version of get_slide_freq_table from rwty — get_slide_freq_table","title":"Optimized version of get_slide_freq_table from rwty — get_slide_freq_table","text":"Optimized version get_slide_freq_table rwty","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_slide_freq_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimized version of get_slide_freq_table from rwty — get_slide_freq_table","text":"","code":"get_slide_freq_table(   tree.list,   burnin = 0,   window.size = 20,   gens.per.tree = 1 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the transition matrix for WF model with HMM (with caching) TODO: add log option for small probabilities — get_transition_mat_wf_hmm","title":"Get the transition matrix for WF model with HMM (with caching) TODO: add log option for small probabilities — get_transition_mat_wf_hmm","text":"Get transition matrix WF model HMM (caching) TODO: add log option small probabilities","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the transition matrix for WF model with HMM (with caching) TODO: add log option for small probabilities — get_transition_mat_wf_hmm","text":"","code":"get_transition_mat_wf_hmm(k, eps, N, ngen, safe = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the transition matrix for WF model with HMM (with caching) TODO: add log option for small probabilities — get_transition_mat_wf_hmm","text":"k number VAF bins eps Variant detection error rate N population size ngen number generations safe whether add small probability avoid 0s","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the transition matrix for WF model with HMM (with caching) TODO: add log option for small probabilities — get_transition_mat_wf_hmm","text":"transition matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function to interpolate non-integer generations — get_transition_mat_wf_hmm_wrapper","title":"Wrapper function to interpolate non-integer generations — get_transition_mat_wf_hmm_wrapper","text":"Wrapper function interpolate non-integer generations","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function to interpolate non-integer generations — get_transition_mat_wf_hmm_wrapper","text":"","code":"get_transition_mat_wf_hmm_wrapper(k, eps, N, ngen, safe = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function to interpolate non-integer generations — get_transition_mat_wf_hmm_wrapper","text":"k number VAF bins eps error rate N population size ngen number generations","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_transition_mat_wf_hmm_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper function to interpolate non-integer generations — get_transition_mat_wf_hmm_wrapper","text":"transition matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_vaf_bins.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate VAF bin midpoints — get_vaf_bins","title":"Generate VAF bin midpoints — get_vaf_bins","text":"Creates k + 2 evenly spaced VAF bins spanning [0, 1] (including boundary bins 0 1) returns midpoints.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_vaf_bins.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate VAF bin midpoints — get_vaf_bins","text":"","code":"get_vaf_bins(k)"},{"path":"https://teng-gao.github.io/mitodrift/reference/get_vaf_bins.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate VAF bin midpoints — get_vaf_bins","text":"k Integer; number interior VAF bins. total number bins k + 2.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/get_vaf_bins.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate VAF bin midpoints — get_vaf_bins","text":"Numeric vector bin midpoints length k + 2.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/gtree_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Smaller example annotated tree built from P_small — gtree_small","title":"Smaller example annotated tree built from P_small — gtree_small","text":"Smaller example annotated tree built P_small","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/gtree_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smaller example annotated tree built from P_small — gtree_small","text":"","code":"gtree_small"},{"path":"https://teng-gao.github.io/mitodrift/reference/gtree_small.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Smaller example annotated tree built from P_small — gtree_small","text":"object class tbl_graph (inherits igraph) length 199.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/label_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate the direct upstream or downstream mutations on the edges — label_edges","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"Annotate direct upstream downstream mutations edges","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/label_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"","code":"label_edges(G)"},{"path":"https://teng-gao.github.io/mitodrift/reference/label_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"G igraph Mutation graph","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/label_edges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"igraph Mutation graph","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/ladderize.html","id":null,"dir":"Reference","previous_headings":"","what":"From ape; will remove once new ape version is released\nhttps://github.com/emmanuelparadis/ape/issues/54 — ladderize","title":"From ape; will remove once new ape version is released\nhttps://github.com/emmanuelparadis/ape/issues/54 — ladderize","text":"ape; remove new ape version released https://github.com/emmanuelparadis/ape/issues/54","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/ladderize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"From ape; will remove once new ape version is released\nhttps://github.com/emmanuelparadis/ape/issues/54 — ladderize","text":"","code":"ladderize(phy, right = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/ladderize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"From ape; will remove once new ape version is released\nhttps://github.com/emmanuelparadis/ape/issues/54 — ladderize","text":"phy phylo phylogeny right logical Whether ladderize right","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/ladderize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"From ape; will remove once new ape version is released\nhttps://github.com/emmanuelparadis/ape/issues/54 — ladderize","text":"","code":"tree_small = ladderize(tree_small)"},{"path":"https://teng-gao.github.io/mitodrift/reference/logSumExp.html","id":null,"dir":"Reference","previous_headings":"","what":"logSumExp function for a vector — logSumExp","title":"logSumExp function for a vector — logSumExp","text":"logSumExp function vector","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/logSumExp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logSumExp function for a vector — logSumExp","text":"","code":"logSumExp(x)"},{"path":"https://teng-gao.github.io/mitodrift/reference/logSumExp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logSumExp function for a vector — logSumExp","text":"x NumericVector","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/logSumExp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logSumExp function for a vector — logSumExp","text":"double logSumExp x","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/long_to_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a long format mutation data frame to a matrix — long_to_mat","title":"Convert a long format mutation data frame to a matrix — long_to_mat","text":"Convert long format mutation data frame matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/long_to_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a long format mutation data frame to a matrix — long_to_mat","text":"","code":"long_to_mat(mut_dat_long, variable)"},{"path":"https://teng-gao.github.io/mitodrift/reference/long_to_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a long format mutation data frame to a matrix — long_to_mat","text":"mut_dat_long data frame columns: variant, cell, variable variable variable convert matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/long_to_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a long format mutation data frame to a matrix — long_to_mat","text":"matrix values","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/make_rooted_nj.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a rooted NJ tree — make_rooted_nj","title":"Make a rooted NJ tree — make_rooted_nj","text":"Make rooted NJ tree","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/make_rooted_nj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a rooted NJ tree — make_rooted_nj","text":"","code":"make_rooted_nj(vmat, dist_method = \"manhattan\", ncores = 1)"},{"path":"https://teng-gao.github.io/mitodrift/reference/make_rooted_nj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a rooted NJ tree — make_rooted_nj","text":"vmat matrix cell--variable values dist_method distance method use ncores Number threads parallelDist::parDist (default: 1)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/make_rooted_nj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a rooted NJ tree — make_rooted_nj","text":"phylo object","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mat_to_long.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert allele count matrix (amat) and total count matrix (dmat) to long format — mat_to_long","title":"Convert allele count matrix (amat) and total count matrix (dmat) to long format — mat_to_long","text":"Convert allele count matrix (amat) total count matrix (dmat) long format","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mat_to_long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert allele count matrix (amat) and total count matrix (dmat) to long format — mat_to_long","text":"","code":"mat_to_long(amat, dmat)"},{"path":"https://teng-gao.github.io/mitodrift/reference/mat_to_long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert allele count matrix (amat) and total count matrix (dmat) to long format — mat_to_long","text":"amat Allele count matrix variants rows cells columns dmat Total count matrix variants rows cells columns","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mat_to_long.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert allele count matrix (amat) and total count matrix (dmat) to long format — mat_to_long","text":"data.table long format columns: variant, cell, (allele count), d (total count)","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_nodes_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Mutation placements calculated from tree_small and P_small — mut_nodes_small","title":"Mutation placements calculated from tree_small and P_small — mut_nodes_small","text":"Mutation placements calculated tree_small P_small","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_nodes_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mutation placements calculated from tree_small and P_small — mut_nodes_small","text":"","code":"mut_nodes_small"},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_nodes_small.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mutation placements calculated from tree_small and P_small — mut_nodes_small","text":"object class data.frame 9 rows 2 columns.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_to_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"Transfer mutation assignment onto single-cell phylogeny","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_to_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"","code":"mut_to_tree(gtree, mut_nodes)"},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_to_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"gtree tbl_graph single-cell phylogeny mut_nodes dataframe Mutation placements","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_to_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"tbl_graph single-cell phylogeny mutation placements","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/mut_to_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"","code":"gtree_small = mut_to_tree(gtree_small, mut_nodes_small)"},{"path":"https://teng-gao.github.io/mitodrift/reference/optimize_tree_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize tree topology using C++ NNI moves — optimize_tree_cpp","title":"Optimize tree topology using C++ NNI moves — optimize_tree_cpp","text":"Performs nearest-neighbor interchange (NNI) hill-climbing find tree topology maximizes belief-propagation score. Uses compiled C++ routines speed.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/optimize_tree_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize tree topology using C++ NNI moves — optimize_tree_cpp","text":"","code":"optimize_tree_cpp(   tree_init = NULL,   logP,   logA,   max_iter = 100,   outfile = NULL,   resume = FALSE,   ncores = 1,   trace_interval = 5 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/optimize_tree_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize tree topology using C++ NNI moves — optimize_tree_cpp","text":"tree_init rooted phylo object used starting tree. Ignored resuming existing trace. logP list log-probability vectors (one per locus), returned convert_logliks_to_logP_list() convert_logliks_to_logP_list_colmajor(). logA numeric vector (list vectors) log transition probabilities, flattened column-major transition matrix. max_iter Integer; maximum number NNI iterations. outfile Optional file path saving tree trace (qs2 format). resume Logical; TRUE outfile exists, resume last saved tree instead starting fresh. ncores Integer; number threads parallel NNI scoring. trace_interval Integer; save trace outfile every many iterations.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/optimize_tree_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize tree topology using C++ NNI moves — optimize_tree_cpp","text":"multiPhylo list trees visited optimization, carrying logZ element log-partition-function score.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/perform_nni.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum likelihood tree search via NNI — perform_nni","title":"Maximum likelihood tree search via NNI — perform_nni","text":"Maximum likelihood tree search via NNI","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/perform_nni.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum likelihood tree search via NNI — perform_nni","text":"","code":"perform_nni(   tree_init,   P,   max_iter = 100,   eps = 0.01,   ncores = 1,   verbose = TRUE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/perform_nni.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum likelihood tree search via NNI — perform_nni","text":"tree_init phylo Intial tree P matrix Genotype probability matrix max_iter integer Maximum number iterations eps numeric Tolerance threshold likelihood difference stopping ncores integer Number cores use verbose logical Verbosity","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/perform_nni.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum likelihood tree search via NNI — perform_nni","text":"multiPhylo List trees corresponding rearrangement steps","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/perform_nni.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximum likelihood tree search via NNI — perform_nni","text":"","code":"tree_list = perform_nni(tree_upgma, P_small) #> Iter 2 -1615.02320811357, 0.061s #> Iter 3 -1612.77216335478, 0.059s #> Iter 4 -1611.12211209167, 0.059s #> Iter 5 -1609.77582445369, 0.059s #> Iter 6 -1608.45689338819, 0.059s #> Iter 7 -1606.49695634113, 0.059s #> Iter 8 -1606.49695634113, 0.059s"},{"path":"https://teng-gao.github.io/mitodrift/reference/phylo_to_gtree.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a phylo object to a tbl_graph — phylo_to_gtree","title":"Convert a phylo object to a tbl_graph — phylo_to_gtree","text":"Builds tbl_graph tip nodes labeled phy$tip.label internal nodes labeled phy$node.label. internal labels missing, created via add_node_names().","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/phylo_to_gtree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a phylo object to a tbl_graph — phylo_to_gtree","text":"","code":"phylo_to_gtree(phy)"},{"path":"https://teng-gao.github.io/mitodrift/reference/phylo_to_gtree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a phylo object to a tbl_graph — phylo_to_gtree","text":"phy phylo object.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/phylo_to_gtree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a phylo object to a tbl_graph — phylo_to_gtree","text":"tbl_graph nodes edges input tree.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_circ.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Circular Phylogenetic Tree with Annotations — plot_phylo_circ","title":"Plot Circular Phylogenetic Tree with Annotations — plot_phylo_circ","text":"Creates circular (fan) layout phylogenetic tree plot optional annotations, feature heatmaps, node confidence values.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_circ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Circular Phylogenetic Tree with Annotations — plot_phylo_circ","text":"","code":"plot_phylo_circ(   gtree,   cell_annot = NULL,   tip_annot = NULL,   feature_mat = NULL,   branch_scores = NULL,   node_conf = FALSE,   conf_label = FALSE,   title = \"\",   pwidth_annot = 0.25,   pwidth_feature = 0.25,   branch_width = 0.3,   dot_size = 1,   conf_min = 0,   conf_max = 0.5,   annot_pal = NULL,   offset = 0.05,   width = 0.8,   label_size = 2,   rescale = FALSE,   limits = c(-2, 2),   feature_legend_title = \"Score\",   flip = TRUE,   annot_legend = TRUE,   feature_legend = TRUE,   layered = FALSE,   smooth_k = 0,   ladderize = TRUE,   open_angle = 0,   feature_axis_label = TRUE,   feature_axis_angle = 30 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_circ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Circular Phylogenetic Tree with Annotations — plot_phylo_circ","text":"gtree phylo object tbl_graph object representing tree. cell_annot data frame list data frames containing cell annotations. Columns include 'cell' 'annot'. tip_annot data frame containing tip annotations. Columns include 'cell' 'annot'. feature_mat matrix features plot heatmap (rows features, columns cells). branch_scores Optional branch scores (currently unused). node_conf Logical. TRUE gtree tbl_graph, plots node confidence. conf_label Logical. TRUE, adds text labels node confidence. title Character string plot title. pwidth_annot Numeric. Width annotation ring(s). pwidth_feature Numeric. Width feature heatmap ring. branch_width Numeric. Line width tree branches. dot_size Numeric. Size tip/node points. conf_min Numeric. Minimum value confidence color scale. conf_max Numeric. Maximum value confidence color scale. annot_pal vector list vectors specifying colors annotations. offset Numeric. Offset distance tree annotation rings. width Numeric. Width heatmap cells. label_size Numeric. Size text labels. rescale Logical. TRUE, rescales features (z-score) heatmap. limits Numeric vector length 2. Limits feature heatmap color scale. feature_legend_title Character string. Title feature heatmap legend. flip Logical. TRUE, flips tree direction. layered Logical. TRUE, plots annotations layered tiles. smooth_k Integer. Number neighbors smoothing features. 0 means smoothing. ladderize Logical. TRUE, ladderizes tree. open_angle Numeric. Angle opening fan layout. feature_axis_label Logical. TRUE, show feature heatmap axis labels; hide FALSE. feature_axis_angle Numeric. Rotation angle (degrees) feature axis text. legend Logical. TRUE, shows legends.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_circ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Circular Phylogenetic Tree with Annotations — plot_phylo_circ","text":"ggtree plot object.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"Plot phylogeny mutation heatmap","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"","code":"plot_phylo_heatmap(tree, P, branch_width = 0.5, root_edge = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"tree phylo tbl_graph Phylogeny P matrix Genotype probability matrix branch_width numeric Branch width root_edge logical Whether plot root edge","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"ggplot Plot visualizing single-cell phylogeny mutation probability heatmap","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"","code":"p = plot_phylo_heatmap(tree_small, P_small)"},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap2.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a phylogenetic tree with VAF heatmap and annotations — plot_phylo_heatmap2","title":"Plot a phylogenetic tree with VAF heatmap and annotations — plot_phylo_heatmap2","text":"Plot phylogenetic tree VAF heatmap annotations","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a phylogenetic tree with VAF heatmap and annotations — plot_phylo_heatmap2","text":"","code":"plot_phylo_heatmap2(   phylo,   df_var = NULL,   branch_width = 0.25,   root_edge = TRUE,   dot_size = 1,   ylim = NULL,   min_cells = 1,   tip_annot = NULL,   annot_scale = NULL,   feature_mat = NULL,   feature_limits = c(-2, 2),   feature_scale = NULL,   rescale = FALSE,   title = NULL,   ytitle = NULL,   xtitle = NULL,   label_site = FALSE,   cell_annot = NULL,   tip_lab = FALSE,   node_lab = FALSE,   layered = FALSE,   annot_bar_height = 0.1,   clade_bar_height = 1,   feature_height = 1,   het_max = 0.1,   conf_min = 0,   conf_max = 1,   conf_label = FALSE,   branch_length = TRUE,   node_conf = FALSE,   annot_pal = NULL,   annot_legend = FALSE,   label_group = FALSE,   text_size = 3,   annot_title_size = text_size,   node_label_size = 1,   mut = NULL,   mark_low_cov = FALSE,   facet_by_group = FALSE,   flip = TRUE,   ladderize = TRUE,   node_scores = NULL,   node_score_limits = c(-4, 4),   variants_highlight = NULL,   show_variant_names = TRUE,   show_tree_y_axis = FALSE,   feature_legend = TRUE,   raster = FALSE,   raster_dpi = 300 )"},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a phylogenetic tree with VAF heatmap and annotations — plot_phylo_heatmap2","text":"df_var Optional data frame variant calls columns cell, variant, either vaf /d computing VAF. branch_width Numeric branch line width tree. root_edge Logical; included compatibility earlier calls. dot_size Numeric size tip/node points. ylim Optional y-axis limits (unused current implementation). min_cells Integer minimum number cells VAF > 0 required keep variant. tip_annot Optional data frame tip annotations columns cell annot. annot_scale Optional ggplot scale annotation colors. feature_mat Optional matrix features (rows = features, columns = cells) plot heatmap. feature_limits Numeric vector length 2 giving limits feature heatmap color scale. feature_scale Optional ggplot scale feature heatmap colors. rescale Logical; TRUE, z-score features per row plotting. title Optional plot title. ytitle Optional VAF heatmap y-axis title. xtitle Optional VAF heatmap x-axis title. label_site Logical; included compatibility earlier calls. cell_annot Optional data frame list data frames annotation bars. tip_lab Logical; TRUE, show tip labels tree. node_lab Logical; TRUE, show internal node labels tree. layered Logical; TRUE, render annotation bars layered tiles. annot_bar_height Numeric height annotation bar panel. clade_bar_height Numeric height clade bar panel (unused current implementation). feature_height Numeric height feature heatmap panel. het_max Numeric maximum VAF heatmap color scaling. conf_min Numeric minimum value confidence color scale. conf_max Numeric maximum value confidence color scale. conf_label Logical; TRUE, label node confidence values. branch_length Logical; FALSE, drop branch lengths plotting. node_conf Logical; TRUE, plot node confidence (requires tbl_graph). annot_pal Optional palette (vector list) annotation bars. annot_legend Logical; TRUE, show annotation legends. label_group Logical; TRUE, label groups annotation bars. text_size Numeric base text size labels. annot_title_size Numeric size annotation strip titles. node_label_size Numeric size node/tip labels. mut Optional mutation column name tree color nodes VAF. mark_low_cov Logical; TRUE, mark low-coverage cells VAF heatmap. facet_by_group Logical; TRUE, facet VAF heatmap group column. flip Logical; TRUE, flip tree orientation. ladderize Logical; TRUE, ladderize tree. node_scores Optional named numeric vector node/tip scores used color tree branches. Names may tip labels, internal node labels, numeric node IDs. node_score_limits Numeric vector length 2 giving limits node score colors. variants_highlight Optional vector variant names bold heatmap axis. show_variant_names Logical; TRUE, show variant tick labels VAF heatmap; hide FALSE. show_tree_y_axis Logical; TRUE, show y-axis ticks/labels tree panel. feature_legend Logical; TRUE, display legend feature heatmap; otherwise hide . raster Logical; TRUE, rasterize plot panel via ggrastr. raster_dpi Numeric DPI use rasterizing panels. tree phylo object tbl_graph tree.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/plot_phylo_heatmap2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a phylogenetic tree with VAF heatmap and annotations — plot_phylo_heatmap2","text":"patchwork/ggplot object combining tree, annotations, heatmaps.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/prop.clades.par.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallelized Clade Support Calculation — prop.clades.par","title":"Parallelized Clade Support Calculation — prop.clades.par","text":"Computes support clade reference phylogeny (phy) across list phylogenetic trees (phy_list). calculation can parallelized across multiple cores efficiency.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/prop.clades.par.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallelized Clade Support Calculation — prop.clades.par","text":"","code":"prop.clades.par(phy, phy_list, rooted = FALSE, ncores = 1, normalize = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/prop.clades.par.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallelized Clade Support Calculation — prop.clades.par","text":"phy reference phylogeny class phylo. phy_list list phylogenetic trees (class phylo) compare reference tree. rooted Logical; whether treat trees rooted. Default FALSE. ncores Integer; number cores use parallel computation. Default 1 (parallelization). normalize Logical; TRUE, support values normalized range 0, 1 dividing number trees. Default TRUE.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/prop.clades.par.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallelized Clade Support Calculation — prop.clades.par","text":"numeric vector clade support values, order internal nodes phy. normalize = TRUE, values proportions; otherwise, counts.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/reorder_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Reorder a phylo object to postorder — reorder_phylo","title":"Reorder a phylo object to postorder — reorder_phylo","text":"Creates deep copy phylogeny reorders edge matrix postorder using compiled C++ helper reorderRcpp.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/reorder_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reorder a phylo object to postorder — reorder_phylo","text":"","code":"reorder_phylo(phy)"},{"path":"https://teng-gao.github.io/mitodrift/reference/reorder_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reorder a phylo object to postorder — reorder_phylo","text":"phy phylo object.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/reorder_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reorder a phylo object to postorder — reorder_phylo","text":"new phylo object edges postorder.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/row_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Moving-average smoothing across matrix rows — row_smooth","title":"Moving-average smoothing across matrix rows — row_smooth","text":"Applies fixed-width moving average independently every row matrix. Missing values can optionally ignored, edge argument controls windows matrix boundaries handled. edge = \"partial\" (default), windows extend past matrix edge shrink available cells, edge = \"full\" enforces full window size returning NA complete window formed.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/row_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Moving-average smoothing across matrix rows — row_smooth","text":"","code":"row_smooth(M, k, na_rm = FALSE, edge = c(\"partial\", \"full\"))"},{"path":"https://teng-gao.github.io/mitodrift/reference/row_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Moving-average smoothing across matrix rows — row_smooth","text":"M Numeric matrix smooth (rows independent series). k Integer window width (must >= 1). na_rm Logical; TRUE, compute means ignoring NAs, otherwise windows containing NA values contribute. edge Either \"partial\" \"full\"; governs boundary handling described .","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/row_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Moving-average smoothing across matrix rows — row_smooth","text":"Matrix dimensions M containing smoothed values.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/run_scistree.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the scistree workflow — run_scistree","title":"Run the scistree workflow — run_scistree","text":"Run scistree workflow","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/run_scistree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the scistree workflow — run_scistree","text":"","code":"run_scistree(   P,   init = \"UPGMA\",   ncores = 1,   max_iter = 100,   eps = 0.01,   verbose = TRUE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/run_scistree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run the scistree workflow — run_scistree","text":"P matrix Genotype probability matrix (cell x mutation). entry probability (0-1) cell harbors mutation init character Initialization strategy; UPGMA NJ ncores integer Number cores use max_iter integer Maximum number iterations eps numeric Tolerance threshold likelihood difference stopping verbose logical Verbosity","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/run_scistree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run the scistree workflow — run_scistree","text":"phylo maximum-likelihood phylogeny","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/run_scistree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run the scistree workflow — run_scistree","text":"","code":"tree_small = run_scistree(P_small) #> Iter 2 -1615.02320811357, 0.061s #> Iter 3 -1612.77216335478, 0.059s #> Iter 4 -1611.12211209167, 0.058s #> Iter 5 -1609.77582445369, 0.059s #> Iter 6 -1608.45689338819, 0.059s #> Iter 7 -1606.49695634113, 0.059s #> Iter 8 -1606.49695634113, 0.059s"},{"path":"https://teng-gao.github.io/mitodrift/reference/run_tree_mcmc_batch.html","id":null,"dir":"Reference","previous_headings":"","what":"Run tree-topology MCMC in batches with convergence monitoring — run_tree_mcmc_batch","title":"Run tree-topology MCMC in batches with convergence monitoring — run_tree_mcmc_batch","text":"Runs MCMC sampling fixed-size batches, computing ASDSF convergence diagnostics batches. Supports automatic stopping ASDSF drops threshold resume previous run.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/run_tree_mcmc_batch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run tree-topology MCMC in batches with convergence monitoring — run_tree_mcmc_batch","text":"","code":"run_tree_mcmc_batch(   phy_init,   logP_list,   logA_vec,   outfile,   diagfile = NULL,   diag = TRUE,   max_iter = 100,   nchains = 1,   ncores = 1,   ncores_qs = 1,   batch_size = 1000,   conv_thres = NULL,   resume = FALSE )"},{"path":"https://teng-gao.github.io/mitodrift/reference/run_tree_mcmc_batch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run tree-topology MCMC in batches with convergence monitoring — run_tree_mcmc_batch","text":"phy_init rooted phylo object used starting tree. logP_list List log-probability vectors (one per locus). logA_vec Numeric vector log transition probabilities. outfile File path saving/resuming full edge-list trace (qs2 format). diagfile Optional file path saving convergence diagnostics (RDS format). diag Logical; whether compute diagnostics (currently unused, diagnostics always computed). max_iter Integer; total number MCMC iterations per chain (ignored conv_thres set). nchains Integer; number independent chains. ncores Integer; number threads C++ MCMC sampling. ncores_qs Integer; number threads qs2 serialization. batch_size Integer; number iterations per batch. conv_thres Numeric NULL; set, run ASDSF drops threshold instead using max_iter. resume Logical; TRUE, resume existing outfile.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/run_tree_mcmc_batch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run tree-topology MCMC in batches with convergence monitoring — run_tree_mcmc_batch","text":"list edge-list chains (one list edge matrices per chain).","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/save_qd_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel qdata saver — save_qd_cpp","title":"Parallel qdata saver — save_qd_cpp","text":"Parallel qdata saver","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/save_qd_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel qdata saver — save_qd_cpp","text":"","code":"save_qd_cpp(   objects,   paths,   compress_level = 3L,   shuffle = TRUE,   grain_size = 1L )"},{"path":"https://teng-gao.github.io/mitodrift/reference/save_qd_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel qdata saver — save_qd_cpp","text":"objects List data-R objects serialize (unsupported types become NULL, mirroring qd_save). paths Character vector output file paths (must match length objects). compress_level Compression level passed qdata (default 3). shuffle Whether enable byte shuffling (default TRUE). grain_size Chunk size parallel processing (default 1).","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/save_qd_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel qdata saver — save_qd_cpp","text":"NULL invisibly success; character vector error messages otherwise.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/score_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Score a tree based on maximum likelihood — score_tree","title":"Score a tree based on maximum likelihood — score_tree","text":"Score tree based maximum likelihood","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/score_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score a tree based on maximum likelihood — score_tree","text":"","code":"score_tree(tree, P, get_l_matrix = FALSE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/score_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score a tree based on maximum likelihood — score_tree","text":"tree phylo object P genotype probability matrix get_l_matrix whether compute whole likelihood matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/score_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score a tree based on maximum likelihood — score_tree","text":"list Likelihood scores tree","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/score_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Score a tree based on maximum likelihood — score_tree","text":"","code":"tree_likelihood = score_tree(tree_upgma, P_small)$l_tree"},{"path":"https://teng-gao.github.io/mitodrift/reference/smooth_features_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth feature matrix over phylogenetic neighbors — smooth_features_phylo","title":"Smooth feature matrix over phylogenetic neighbors — smooth_features_phylo","text":"Smooth feature matrix phylogenetic neighbors","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/smooth_features_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth feature matrix over phylogenetic neighbors — smooth_features_phylo","text":"","code":"smooth_features_phylo(feature_mat, phylo, k = 5, ties_method = \"random\")"},{"path":"https://teng-gao.github.io/mitodrift/reference/smooth_features_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth feature matrix over phylogenetic neighbors — smooth_features_phylo","text":"feature_mat matrix features rows cells columns phylo phylo object k Number nearest neighbors (including self) smooth ties_method Method handle ties distance: \"min\" (include ties, default), \"random\", \"first\"","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/smooth_features_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth feature matrix over phylogenetic neighbors — smooth_features_phylo","text":"smoothed matrix","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/to_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert the phylogeny from tidygraph to phylo object\nmodified from R package alakazam, converts a tbl_graph to a phylo object — to_phylo","title":"Convert the phylogeny from tidygraph to phylo object\nmodified from R package alakazam, converts a tbl_graph to a phylo object — to_phylo","text":"Convert phylogeny tidygraph phylo object modified R package alakazam, converts tbl_graph phylo object","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/to_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert the phylogeny from tidygraph to phylo object\nmodified from R package alakazam, converts a tbl_graph to a phylo object — to_phylo","text":"","code":"to_phylo(graph)"},{"path":"https://teng-gao.github.io/mitodrift/reference/to_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert the phylogeny from tidygraph to phylo object\nmodified from R package alakazam, converts a tbl_graph to a phylo object — to_phylo","text":"graph tbl_graph single-cell phylogeny","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/to_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert the phylogeny from tidygraph to phylo object\nmodified from R package alakazam, converts a tbl_graph to a phylo object — to_phylo","text":"phylo single-cell phylogeny","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/to_phylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert the phylogeny from tidygraph to phylo object\nmodified from R package alakazam, converts a tbl_graph to a phylo object — to_phylo","text":"","code":"tree_small = to_phylo(annotate_tree(tree_small, P_small))"},{"path":"https://teng-gao.github.io/mitodrift/reference/transfer_links.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate the direct upstream or downstream node on the edges — transfer_links","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"Annotate direct upstream downstream node edges","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/transfer_links.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"","code":"transfer_links(G)"},{"path":"https://teng-gao.github.io/mitodrift/reference/transfer_links.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"G igraph Mutation graph","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/transfer_links.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"igraph Mutation graph","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/tree_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Smaller example tree built from P_small — tree_small","title":"Smaller example tree built from P_small — tree_small","text":"Smaller example tree built P_small","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/tree_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smaller example tree built from P_small — tree_small","text":"","code":"tree_small"},{"path":"https://teng-gao.github.io/mitodrift/reference/tree_small.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Smaller example tree built from P_small — tree_small","text":"object class phylo length 5.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/tree_upgma.html","id":null,"dir":"Reference","previous_headings":"","what":"Example tree built using UPGMA from P_small — tree_upgma","title":"Example tree built using UPGMA from P_small — tree_upgma","text":"Example tree built using UPGMA P_small","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/tree_upgma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example tree built using UPGMA from P_small — tree_upgma","text":"","code":"tree_upgma"},{"path":"https://teng-gao.github.io/mitodrift/reference/tree_upgma.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example tree built using UPGMA from P_small — tree_upgma","text":"object class phylo length 4.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse weak clades below a confidence threshold. — trim_tree","title":"Collapse weak clades below a confidence threshold. — trim_tree","text":"Given fully binary phylogeny per-node confidence scores stored tree$node.label, helper collapses every internal node whose confidence falls conf, effectively pruning low-support clades retaining higher-confidence structure.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse weak clades below a confidence threshold. — trim_tree","text":"","code":"trim_tree(tree, conf, collapse_trivial = TRUE)"},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse weak clades below a confidence threshold. — trim_tree","text":"tree binary phylo object whose node.label vector stores posterior/confidence values internal nodes. conf Numeric threshold $0,1$. Internal nodes confidence value collapsed. collapse_trivial Logical; TRUE, collapses trivial root-adjacent singleton split (1 tip vs rest) root polytomy.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse weak clades below a confidence threshold. — trim_tree","text":"renumbered phylo object low-confidence nodes collapsed.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse branches with high expected mis-assignments. — trim_tree_exp","title":"Collapse branches with high expected mis-assignments. — trim_tree_exp","text":"Computes expected number incorrectly assigned tips internal branch (based (1 - p) * clade size, p branch confidence) collapses branches whose expectation exceeds tolerance derived total number tips.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse branches with high expected mis-assignments. — trim_tree_exp","text":"","code":"trim_tree_exp(tree, tol)"},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse branches with high expected mis-assignments. — trim_tree_exp","text":"tree binary phylo object internal node confidence scores tree$node.label. tol Numeric tolerance expressed fraction total tips; threshold length(tree$tip.label) * tol expected errors.","code":""},{"path":"https://teng-gao.github.io/mitodrift/reference/trim_tree_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse branches with high expected mis-assignments. — trim_tree_exp","text":"renumbered phylo object overly uncertain branches collapsed.","code":""},{"path":"https://teng-gao.github.io/mitodrift/news/index.html","id":"mitodrift-102","dir":"Changelog","previous_headings":"","what":"mitodrift 1.0.2","title":"mitodrift 1.0.2","text":"Initial public release.","code":""}]
