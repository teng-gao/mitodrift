% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mitodrift.R
\name{optimize_tree_cpp}
\alias{optimize_tree_cpp}
\title{Optimize tree topology using C++ NNI moves}
\usage{
optimize_tree_cpp(
  tree_init = NULL,
  logP,
  logA,
  max_iter = 100,
  outfile = NULL,
  resume = FALSE,
  ncores = 1,
  trace_interval = 5
)
}
\arguments{
\item{tree_init}{A rooted \code{phylo} object used as the starting tree.
Ignored when resuming from an existing trace.}

\item{logP}{A list of log-probability vectors (one per locus), as returned
by \code{\link[=convert_logliks_to_logP_list]{convert_logliks_to_logP_list()}} or \code{\link[=convert_logliks_to_logP_list_colmajor]{convert_logliks_to_logP_list_colmajor()}}.}

\item{logA}{A numeric vector (or list of vectors) of log transition
probabilities, flattened column-major from the transition matrix.}

\item{max_iter}{Integer; maximum number of NNI iterations.}

\item{outfile}{Optional file path for saving the tree trace (qs2 format).}

\item{resume}{Logical; if \code{TRUE} and \code{outfile} exists, resume from the
last saved tree instead of starting fresh.}

\item{ncores}{Integer; number of threads for parallel NNI scoring.}

\item{trace_interval}{Integer; save the trace to \code{outfile} every this many
iterations.}
}
\value{
A \code{multiPhylo} list of trees visited during optimization, each
carrying a \code{logZ} element with the log-partition-function score.
}
\description{
Performs nearest-neighbor interchange (NNI) hill-climbing to find the
tree topology that maximizes the belief-propagation score. Uses compiled
C++ routines for speed.
}
