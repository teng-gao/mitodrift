% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mitodrift.R
\name{run_tree_mcmc_batch}
\alias{run_tree_mcmc_batch}
\title{Run tree-topology MCMC in batches with convergence monitoring}
\usage{
run_tree_mcmc_batch(
  phy_init,
  logP_list,
  logA_vec,
  outfile,
  diagfile = NULL,
  diag = TRUE,
  max_iter = 100,
  nchains = 1,
  ncores = 1,
  ncores_qs = 1,
  batch_size = 1000,
  conv_thres = NULL,
  resume = FALSE
)
}
\arguments{
\item{phy_init}{A rooted \code{phylo} object used as the starting tree.}

\item{logP_list}{List of log-probability vectors (one per locus).}

\item{logA_vec}{Numeric vector of log transition probabilities.}

\item{outfile}{File path for saving/resuming the full edge-list trace
(qs2 format).}

\item{diagfile}{Optional file path for saving convergence diagnostics
(RDS format).}

\item{diag}{Logical; whether to compute diagnostics (currently unused,
diagnostics are always computed).}

\item{max_iter}{Integer; total number of MCMC iterations per chain
(ignored when \code{conv_thres} is set).}

\item{nchains}{Integer; number of independent chains.}

\item{ncores}{Integer; number of threads for C++ MCMC sampling.}

\item{ncores_qs}{Integer; number of threads for qs2 serialization.}

\item{batch_size}{Integer; number of iterations per batch.}

\item{conv_thres}{Numeric or \code{NULL}; if set, run until the ASDSF drops
below this threshold instead of using \code{max_iter}.}

\item{resume}{Logical; if \code{TRUE}, resume from existing \code{outfile}.}
}
\value{
A list of edge-list chains (one list of edge matrices per chain).
}
\description{
Runs MCMC sampling in fixed-size batches, computing ASDSF convergence
diagnostics between batches. Supports automatic stopping when ASDSF
drops below a threshold and resume from a previous run.
}
