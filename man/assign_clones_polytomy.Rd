% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{assign_clones_polytomy}
\alias{assign_clones_polytomy}
\title{Assign clone IDs to a tree allowing small polytomies.}
\usage{
assign_clones_polytomy(tree, k = Inf, paraphyletic = FALSE, return_df = TRUE)
}
\arguments{
\item{tree}{Rooted \code{phylo} object with bifurcating or polytomous structure.}

\item{k}{Positive scalar; maximum clade size that collapses into one clone.}

\item{paraphyletic}{Logical; if \code{TRUE}, leftover unassigned tips below a node
are grouped into one clone, otherwise each becomes a singleton.}

\item{return_df}{Logical; if \code{TRUE}, returns a data frame annotated per tip,
otherwise an integer vector of clone assignments.}
}
\value{
Either a data frame with columns \code{cell}, \code{clade}, \code{annot}, \code{size},
\code{frac} or an integer vector of clone IDs indexed by tip order.
}
\description{
Assign clone IDs to a tree allowing small polytomies.
}
\details{
Finds the root (node never used as a child), recurses over internal
nodes, and assigns clone IDs whenever a clade has \verb{<= k} tips. Tips directly
attached to the root are always singleton clones. Ensures all tips receive
an assignment, warning if late singletons are required.
}
