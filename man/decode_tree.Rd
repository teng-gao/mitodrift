% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mitodrift.R
\name{decode_tree}
\alias{decode_tree}
\title{Decode a tree using CRF belief propagation (R version)}
\usage{
decode_tree(
  tn,
  A,
  liks,
  post_max = FALSE,
  store_bels = FALSE,
  store_crfs = FALSE,
  debug = FALSE,
  score_only = FALSE
)
}
\arguments{
\item{tn}{A \code{phylo} object representing the tree topology.}

\item{A}{Transition matrix (square, \verb{k x k}) with VAF bin midpoints as
row/column names.}

\item{liks}{Named list of likelihood matrices (one per variant), each
\verb{k x n_cells}.}

\item{post_max}{Logical; if \code{TRUE}, also compute MAP (Viterbi) decoding.}

\item{store_bels}{Logical; if \code{TRUE}, store per-variant node and edge
beliefs in the output.}

\item{store_crfs}{Logical; if \code{TRUE}, store a copy of the CRF object for
each variant.}

\item{debug}{Logical; if \code{TRUE}, return a detailed list instead of just
the \code{tbl_graph}.}

\item{score_only}{Logical; if \code{TRUE}, skip posterior computation and only
attach log-partition scores.}
}
\value{
A \code{tbl_graph} tree with per-variant posterior means (columns
\verb{p_<variant>}) and a \code{logZ} vector of log-partition-function values.
When \code{debug = TRUE}, a list with additional diagnostic components.
}
\description{
Constructs a conditional random field (CRF) on the tree with a single
shared transition matrix and computes per-variant marginal beliefs via
tree belief propagation. Optionally returns posterior means, MAP
assignments, or the full CRF objects.
}
\keyword{internal}
